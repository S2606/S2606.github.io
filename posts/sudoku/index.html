<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=content-language content="en"><meta http-equiv=content-security-policy content="upgrade-insecure-requests; block-all-mixed-content; default-src 'self'; child-src 'self'; font-src 'self' https://fonts.gstatic.com https://cdn.jsdelivr.net/; form-action 'self'; frame-src 'self'; img-src 'self'; object-src 'none'; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com/ https://cdn.jsdelivr.net/; script-src 'self' 'unsafe-inline' https://www.google-analytics.com; prefetch-src 'self';"><meta name=author content="Shagun Khemka"><meta name=description content="What is sudoku? Sudoku is a 81 square game, whereing all you need to do is just enter a single digit number(1-9)(and not 0 Computer Nerds know why I said this :) ) in a box.
2 - 7 |9 - 5 |- 8 1 8 - 3 |7 - 6 |- 4 9 4 - 1 |8 - 3 |- 7 6 ------+------+------ - - - |4 - 8 |1 9 2 3 8 4 |1 9 2 |- - - - - - |- - - |4 3 8 ------+------+------ - - - |- 7 - |8 - 5 9 - 5 |- 8 - |7 - 4 7 - 8 |- 6 - |9 - 3 Sounds easy right?"><meta name=keywords content="blog,developer,personal"><meta name=twitter:card content="summary"><meta name=twitter:title content="Sudoku in Python"><meta name=twitter:description content="What is sudoku? Sudoku is a 81 square game, whereing all you need to do is just enter a single digit number(1-9)(and not 0 Computer Nerds know why I said this :) ) in a box.
2 - 7 |9 - 5 |- 8 1 8 - 3 |7 - 6 |- 4 9 4 - 1 |8 - 3 |- 7 6 ------+------+------ - - - |4 - 8 |1 9 2 3 8 4 |1 9 2 |- - - - - - |- - - |4 3 8 ------+------+------ - - - |- 7 - |8 - 5 9 - 5 |- 8 - |7 - 4 7 - 8 |- 6 - |9 - 3 Sounds easy right?"><meta property="og:title" content="Sudoku in Python"><meta property="og:description" content="What is sudoku? Sudoku is a 81 square game, whereing all you need to do is just enter a single digit number(1-9)(and not 0 Computer Nerds know why I said this :) ) in a box.
2 - 7 |9 - 5 |- 8 1 8 - 3 |7 - 6 |- 4 9 4 - 1 |8 - 3 |- 7 6 ------+------+------ - - - |4 - 8 |1 9 2 3 8 4 |1 9 2 |- - - - - - |- - - |4 3 8 ------+------+------ - - - |- 7 - |8 - 5 9 - 5 |- 8 - |7 - 4 7 - 8 |- 6 - |9 - 3 Sounds easy right?"><meta property="og:type" content="article"><meta property="og:url" content="http://s2606.github.io/posts/sudoku/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-07-21T00:00:00+00:00"><meta property="article:modified_time" content="2021-07-21T00:00:00+00:00"><title>Sudoku in Python · Shagun Khemka</title><link rel=canonical href=http://s2606.github.io/posts/sudoku/><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700&display=swap" rel=stylesheet><link rel=preload href="../../fonts/forkawesome-webfont.woff2?v=1.1.7" as=font type=font/woff2 crossorigin><link rel=stylesheet href=../../css/coder.min.1e20eb1891b094bf69a343bcb654081c591a2e1af874963097b5c252c4ab2849.css integrity="sha256-HiDrGJGwlL9po0O8tlQIHFkaLhr4dJYwl7XCUsSrKEk=" crossorigin=anonymous media=screen><link rel=stylesheet href=../../css/coder-dark.min.126ad3988d46bdae6217a11105b53c9662bca05f39d42d3c0fb366919d334620.css integrity="sha256-EmrTmI1Gva5iF6ERBbU8lmK8oF851C08D7NmkZ0zRiA=" crossorigin=anonymous media=screen><link rel=icon type=image/png href=../../images/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=../../images/favicon-16x16.png sizes=16x16><link rel=apple-touch-icon href=../../images/apple-touch-icon.png><link rel=apple-touch-icon sizes=180x180 href=../../images/apple-touch-icon.png><script defer src=https://twemoji.maxcdn.com/v/13.0.1/twemoji.min.js integrity=sha384-5f4X0lBluNY/Ib4VhGx0Pf6iDCF99VGXJIyYy7dDLY5QlEd7Ap0hICSSZA1XYbc4 crossorigin=anonymous></script><meta name=generator content="Hugo 0.81.0"></head><body class=colorscheme-auto onload=twemoji.parse(document.body)><div class=float-container><a id=dark-mode-toggle class=colorscheme-toggle><i class="fa fa-adjust fa-fw" aria-hidden=true></i></a></div><main class=wrapper><nav class=navigation><section class=container><a class=navigation-title href=../../>Shagun Khemka</a>
<input type=checkbox id=menu-toggle>
<label class="menu-button float-right" for=menu-toggle><i class="fa fa-bars fa-fw" aria-hidden=true></i></label><ul class=navigation-list><li class=navigation-item><a class=navigation-link href=../../about/>About</a></li><li class=navigation-item><a class=navigation-link href=../../posts/>Blog</a></li></ul></section></nav><div class=content><section class="container post"><article><header><div class=post-title><h1 class=title>Sudoku in Python</h1></div><div class=post-meta><div class=date><span class=posted-on><i class="fa fa-calendar" aria-hidden=true></i><time datetime=2021-07-21T00:00:00Z>July 21, 2021</time></span>
<span class=reading-time><i class="fa fa-clock-o" aria-hidden=true></i>7-minute read</span></div></div></header><div><h2 id=what-is-sudoku>What is sudoku?</h2><p>Sudoku is a 81 square game, whereing all you need to do is just enter a single digit number(1-9)(and not 0 Computer Nerds know why I said this :) ) in a box.</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>    2 - 7 |9 - 5 |- 8 1
    8 - 3 |7 - 6 |- 4 9
    4 - 1 |8 - 3 |- 7 6
    ------+------+------
    - - - |4 - 8 |1 9 2
    3 8 4 |1 9 2 |- - -
    - - - |- - - |4 3 8
    ------+------+------
    - - - |- 7 - |8 - 5
    9 - 5 |- 8 - |7 - 4
    7 - 8 |- 6 - |9 - 3
</code></pre></div><p>Sounds easy right? Not Really. There are some rules to this, particularly w.r.t How to add a number, a number can only be added in a box</p><p>if and only if it is unique in a ROW, COLUMN, or a 3x3 BOX as shown below:-</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>  Box       Block   Column
   |          |        |
    \       - - -      |
    [2] - 7|9 - 5 |- 8 1
     8 - 3 |7 - 6 |- 4 9
     4 - 1 |8 - 3 |- 7 6
            - - -
     ------+------+------
     - - - |4 - 8 |1 9 2 --- Row
     3 8 4 |1 9 2 |- - -
     - - - |- - - |4 3 8
     ------+------+------
     - - - |- 7 - |8 - 5
     9 - 5 |- 8 - |7 - 4
     7 - 8 |- 6 - |9 - 3
</code></pre></div><p>So how about lets make it more intresting and solve it not with pen/pencil, but with python code(Why python, easy for demonstration purpose, can use any other programming language).</p><p>There are many ways in which this problem can be solved, <a href=https://leetcode.com/problems/sudoku-solver/>BackTracking</a> being one of them.
The method which I will show is a bit different not because its unique in terms of algorithm, but in terms of thinking with a different angle.</p><h3 id=what-did-you-mean-by-the-last-sentence>What did you mean by the last sentence?</h3><p>Imagine you have a Multiple Choice Question(MCQ) with 4 options. Now the probability of one option being correct is 25%(1/4). Now lets suppose magically/logically you know that one option is not correct, the odds of one option being correct has increased to 33%(1/3). This can go as high as 50%(1/2). The lesson that can be taken is sometimes in order to reach the right answer, one way the can be used is to eliminate the wrong ones. And that&rsquo;s what we are gonna do here.</p><h3 id=how-exactly>How exactly?</h3><ol><li><p>The Box in which numbers will be filled</p><p>for this, we will not really use 9x9 2D Array, instead have shown how exactly would the data structure look like</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback> # Intead on naming row by their index, will use conventions such as A1, A2....H9
 rows = &#39;ABCDEFGHI&#39;
 cols = &#39;123456789&#39;

 # Cross product of elements in A and elements in B.
 def cross(A, B):
     return [s + t for s in A for t in B]

 # Something like [A1, .., B2,....]
 boxes = cross(rows, cols)

 # Define row units of a sudoku
 # Something like [[A1,...], [B1,....]]
 row_units = [cross(r, cols) for r in rows]

 # Define column units of a sudoku
 # Something like [[A1,...], [A2,....]]
 row_units = [cross(r, cols) for r in rows]

 # Define square units of a sudoku
 # Something like [[A1,A2,...,B1,..], [A4,....]]
 square_units = [cross(rs, cs) for rs in (&#39;ABC&#39;, &#39;DEF&#39;, &#39;GHI&#39;) for cs in (&#39;123&#39;, &#39;456&#39;, &#39;789&#39;)]

 # Define diagonal units of a sudoku
 # Something like [[A1,B2,..], [...]]
 diagonal_units = [[x + y for x, y in zip(rows, cols)], [x + y for x, y in zip(rows, cols[::-1])]]

 # Create a list of all units of a sudoku
 unitlist = row_units + column_units + square_units + diagonal_units

 # Create a dictionary of peers of each box
 # Something like {&#39;I6&#39;: set([&#39;I9&#39;, &#39;I8...])}
 units = dict((s, [u for u in unitlist if s in u]) for s in boxes)
 peers = dict((s, set(sum(units[s], [])) - {s}) for s in boxes)

</code></pre></div></li><li><p>Since everthing&rsquo;s in place, lets start the process. Just a Disclaimer, the input will be</p><p>taken in string format, sort of like this(2&mldr;&mldr;&mldr;&mldr;.6) where . is empty boxes. After fetching the</p><p>input, replace the . with values that can be added(whole set for now) in a box.</p><p>Something like - {&lsquo;I6&rsquo;: &lsquo;123456789&rsquo;&mldr;}</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback> chars = []
 digits = &#39;123456789&#39;
 for c in grid:
     if c in digits:
         chars.append(c)
     if c == &#39;.&#39;:
         chars.append(digits)
 assert len(chars) == 81
 return dict(zip(boxes, chars))

</code></pre></div></li><li><p>Having added elements that can be added, it time for elimination part, this is further divided into
sub parts</p><p>3.1) First we shall perform elimination such that if a box has a value, it does not make sense to keep them in the box&rsquo;s peer.</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback># Here values is the dict. mentioned above
solved_values = [box for box in values.keys() if len(values[box]) == 1] # Fetch those boxes that have only 1 value
for box in solved_values:
    digit = values[box] # Fetch the single digit
    for peer in peers[box]:
        values[peer] = values[peer].replace(digit, &#39;&#39;) # Sort of remove the digit from larger number pool
return values
</code></pre></div><p>3.2) This is followed by Naked Twins Strategy(don&rsquo;t know who gave this name). Now I wanted to explain it in words but <a href=https://www.learn-sudoku.com/naked-pairs.html>this link</a> has just made it easier to understand it.</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>NOTE:- Please watch the tutorial before moving ahead

naked_twin_dic = {}
for unit in unitlist:
    # Build a dictionary to identify a naked twin pair
    vdic = {}
    for box in unit:
        # Identify box containing only 2 possibilities as a candidate for a naked twin
        if len(values[box]) == 2:
            if not values[box] in vdic:
                vdic[values[box]] = [box]
            else:
                vdic[values[box]].append(box)
    # Examine the dictionary to validate the candidates present as
    # naked twin pairs
    for key in vdic:
        # Condition for the candidate to be a naked twin pair
        if len(vdic[key]) == 2:
            if not key in naked_twin_dic:
                naked_twin_dic[key] = [unit]
            else:
                naked_twin_dic[key].append(unit)

# now naked twin dict will have key as 2 possibilites and value as array of bozes that have them
# eg:- {&#39;57&#39;: [[&#39;A1&#39;, &#39;B2&#39;, &#39;C3&#39;, &#39;D4&#39;, &#39;E5&#39;, &#39;F6&#39;, &#39;G7&#39;, &#39;H8&#39;, &#39;I9&#39;]]}
# Eliminate the naked twins as possibilities for their peers
for key in naked_twin_dic:
    for unit in naked_twin_dic[key]:
        for box in unit:
            if values[box] != key:
                assign_value(values, box, values[box].replace(key[0], &#39;&#39;))
                assign_value(values, box, values[box].replace(key[1], &#39;&#39;))
</code></pre></div><p>3.3) At the end, a bit counter-intuitive move is done wherein the box in which only value is possible in one box, will set that value in the box.</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>for unit in unitlist:
for digit in &#39;123456789&#39;:
    dplaces = [box for box in unit if digit in values[box]]
    # This line checks if only one value is possible in one box
    if len(dplaces) == 1:
        values[dplaces[0]] = digit
return values

</code></pre></div></li><li><p>One these reductions are done, will check if there comes a points wherein it cannot be reduced further. Will also add a check if there arises a box which was left empty, thereby proving that sudoku cannot be solved ;), will simply return false</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>while not stalled:
    solved_values_before = len([box for box in values.keys() if len(values[box]) == 1])
    values = eliminate(values)
    values = naked_twins(values)
    values = only_choice(values)
    solved_values_after = len([box for box in values.keys() if len(values[box]) == 1])
    # Check if it can be solved further(happy flow)
    stalled = solved_values_before == solved_values_after
    # Check if it can be solved further(sad flow)
    if len([box for box in values.keys() if len(values[box]) == 0]):
        return False
</code></pre></div></li><li><p>Now the next problem is how do we iterate(i.e. to go to each square and do the necessary computations), for this DFS(Depth First Search) is considered. Reason is that backtracking is needed for restarting from a different path. The traversal starts from box of fewest possibilities(think why?)</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>values = reduce_puzzle(values) # do the reduction part
if values is False:
    return False  ## Failed
if all(len(values[s]) == 1 for s in boxes):
    return values  ## Solved!
# Choose one of the unfilled boxes with the fewest possibilities
n, s = min((len(values[s]), s) for s in boxes if len(values[s]) &gt; 1)
# Now use recurrence to solve each one of the resulting sudokus
for value in values[s]:
    new_sudoku = values.copy()
    new_sudoku[s] = value
    attempt = search(new_sudoku)
    if attempt:
        return attempt
</code></pre></div></li><li><p>And TADA: Your very own sudoku is solved</p><div class=highlight><pre style=color:#e5e5e5;background-color:#000;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>2 6 7 |9 4 5 |3 8 1
8 5 3 |7 1 6 |2 4 9
4 9 1 |8 2 3 |5 7 6
------+------+------
5 7 6 |4 3 8 |1 9 2
3 8 4 |1 9 2 |6 5 7
1 2 9 |6 5 7 |4 3 8
------+------+------
6 4 2 |3 7 9 |8 1 5
9 3 5 |2 8 1 |7 6 4
7 1 8 |5 6 4 |9 2 3

</code></pre></div></li></ol><p>Woah! This was quite a mental exercise. Hope you had fun learning along with me. See you around</p></div><footer></footer></article></section></div><footer class=footer><section class=container>©
2017 -
2021
Shagun Khemka
·
Powered by <a href=https://gohugo.io/>Hugo</a> & <a href=https://github.com/luizdepra/hugo-coder/>Coder</a>.</section></footer></main><script src=../../js/dark-mode.min.aee9c8a464eb7b3534c7110f7c5e169e7039e2fd92710e0626d451d6725af137.js></script></body></html>